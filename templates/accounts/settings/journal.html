{% extends "base.html" %}
{% load i18n static %}

{% block title %}{% trans "Journal" %} &mdash; YDNS{% endblock %}

{% block content %}
	<div class="row">
	    <div class="col-lg-3">
            {% include "accounts/settings/sidenav.html" %}
		</div>
	    <div class="col-lg-9">
			<section class="section">
				<h3 class="section-header page-header">
					{% trans "Journal" %}
				    <span class="pull-right">
					    <a href="{% url 'accounts:settings:clear_journal' %}" class="btn btn-link">{% trans "Clear Journal" %}</a>
				    </span>
				</h3>
			    <p>{% trans "The journal is used to track account-sensive information to provide a better security level." %}</p>
			    <p>{% trans "<strong>Note:</strong> Clearing the journal will create a log entry for that action as well." %}</p>
			    {% with log=user.get_log_messages %}
			    	<table class="table table-striped table-bordered">
			    		<thead>
			    			<tr>
			    				<th>{% trans "Date" %}</th>
			    				<th>{% trans "Action" %}</th>
			    				<th>{% trans "IP Address" %}</th>
			    				<th>{% trans "User agent" %}</th>
			    			</tr>
			    		</thead>
			    		<tbody>
			    			{% for msg in log %}<tr>
			    				<td>{{ msg.date_created|date:_('Y/m/d H:i:s T') }}</td>
			    				<td>{{ msg.get_translated_message }}</td>
			    				<td>{{ msg.ip|default:_('not available') }}</td>
			    				<td class="journal-user-agent"{% if msg.meta.user_agent %} title="{{ msg.meta.user_agent }}"{% endif %}>
			    					{{ msg.get_user_agent|default:_('not available') }}
			    				</td>
			    			</tr>{% endfor %}
			    		</tbody>
			    	</table>
			    {% endwith %}
	        </section>
	    </div>
	</div>
{% endblock %}

{% block js %}
	<script type="text/javascript">
		$(function() {
			$('[data-nav-id="journal"]').addClass('active');
		});
	</script>
{% endblock %}